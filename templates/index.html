<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>Chat App</title>
  <link rel="stylesheet" href="bootstrap.min.css">
  <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
  <style>
    /* Minimal reset */
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: Georgia; background-color: black; height: 100vh; }

    /* Top bar */
    .div1{
      display: grid; margin: 1vh; border-radius: 1.5vh; color: white;
      place-items: center; height: 10vh; background-color: blue;
    }
    h1{ font-size: 7vh; font-weight: 400; }

    .main{ z-index: 6; max-height: 100vh; height: 95%; position: relative; }

    /* Messages area */
    #messages {
      position: absolute; top: 12vh; bottom: 12vh; left: 2vh; right: 2vh;
      overflow-y: auto; padding: 10px; background: #222; border-radius: 10px; color: white;
      display: flex; flex-direction: column; gap: 6px; height: 90%;
    }
    .msg {
      background: #444; padding: 8px 12px; font-size: 3vh; width: max-content;
      border-left: 0.5vh solid yellow; border-bottom: 0.25vh solid orange;
      max-width: 85%; word-wrap: break-word; white-space: pre-wrap;
    }
    .msg.me {
      align-self: flex-end;
      border-left-color: blue; /* green accent for your messages */
      border-bottom-color: #21c55d;
      background: #3d3d3d;
    }

    /* Input + send (fixed height, no shrinking) */
    .chatbox{
      position: absolute; bottom: 2vh; left: 1.5vh; right: 12vh;
      height: 10vh; border-radius: 5vh; background-color: white;
      display: flex; align-items: center; padding: 0 3vh;
    }
    .input{ width: 100%; font-size: 3vh; border: none; outline: none; }
    .submit{
      position: absolute; bottom: 2vh; right: 1.5vh;
      height:10vh; width:10vh; border-radius: 50%;
      display: flex; align-items: center; justify-content: center;
      background-color: yellowgreen; cursor: pointer;
    }
    .submit1{ font-size: 3.5vh; border: none; background-color: transparent; color: white; }
    .submit1:focus{ outline: none; }

    /* Three-dot (hamburger-style) menu button */
    .td{
      position: absolute; top: 3.5vh; right: 3vh;
      transition: transform 0.25s ease-in; z-index: 8; cursor: pointer;
      display: grid; gap: 0.3vh; justify-items: center;
    }
    .ro{ transform: rotate(90deg); }
    dt{
      background-color: white; height: 1vh; width: 1vh; border-radius: 100%;
      display: block;
    }

    /* Slide-out menu box */
    .header{
      background-color: black; border-radius: 5vh; height: 22vh; width: 22vh;
      position: fixed; top: 12.5vh; right: 1vh; opacity: 0; z-index: -1;
      display: grid; place-items: center; transition: opacity .2s ease, transform .2s ease, z-index 0s linear .2s;
      transform: translateY(-8px);
    }
    /* Visible state */
    .header.open{
      opacity: 1; z-index: 999; transform: translateY(0); transition: opacity .2s ease, transform 0.2s ease;
      background: rgba(0, 123, 255, 0.3);
  backdrop-filter: blur(10px);
  border-radius: 15px;
  padding: 15px;
  color: white;
    }
    ul{ list-style: none; margin: 0; padding: 0;
    font-family: Comic Sans MS;
    font-weight: 500;
    }
    li, a{ font-size: 2.75vh;
    border-bottom: 2px solid blue;
    color: blue; text-decoration: none;
    }
    a:focus{ text-decoration: none; }
  </style>
</head>
<body>
  <!-- Slide menu -->
  <div class="header" id="menu">
    <ul>
      <li><a href="https://L2hport.is-a.dev">➡ Portfolio</a></li>
      <li><a href="https://anuragl2h.github.io/L2h-anitrest/index.html">➡ Anime Story</a></li>
      <li><a href="https://discord.gg/urRpFsdJ">➡ Join Discord</a></li>
    </ul>
  </div>

  <div class="main">
    <div class="div1">
      <h1>Chat App</h1>
      <!-- Three-dot hamburger trigger -->
      <section class="td" id="menuBtn" aria-label="Open menu">
        <dt></dt><dt></dt><dt></dt>
      </section>
    </div>

    <!-- Chat messages -->
    <div id="messages"></div>

    <!-- Input area -->
    <div class="chatbox">
      <input type="text" id="message" name="message" placeholder="send.." class="input" autocomplete="off">
    </div>
    <div class="submit">
      <button class="submit1" id="sendBtn" aria-label="Send">➤</button>
    </div>
  </div>

  <script>
    // --- WebSocket setup ---
    const socket = io();
    const name = prompt("Enter your name") || "Anonymous";

    // Receive messages
    socket.on("message", function(msg) {
      const box = document.getElementById("messages");
      const div = document.createElement("div");
      const isMe = msg.startsWith(name + ": ");
      div.className = "msg" + (isMe ? " me" : "");
      div.textContent = msg;
      box.appendChild(div);
      box.scrollTop = box.scrollHeight;
    });

    // Send messages
    function sendMessage() {
      const input = document.getElementById("message");
      const msg = input.value.trim();
      if (!msg) return;
      // Prefix name BEFORE sending so everyone sees the correct sender
      socket.send(`${name}: ${msg}`);
      input.value = "";
      input.focus();
    }

    // Click send
    document.getElementById("sendBtn").addEventListener("click", sendMessage);

    // Enter to send
    document.getElementById("message").addEventListener("keydown", (e) => {
      if (e.key === "Enter") {
        e.preventDefault();
        sendMessage();
      }
    });

    // --- Menu (hamburger) toggle ---
    const menu = document.getElementById("menu");
    const menuBtn = document.getElementById("menuBtn");

    function toggleMenu() {
      menu.classList.toggle("open");
      menuBtn.classList.toggle("ro");
    }
    menuBtn.addEventListener("click", toggleMenu);

    // Close menu on outside click / Esc
    document.addEventListener("click", (e) => {
      if (!menu.contains(e.target) && !menuBtn.contains(e.target)) {
        if (menu.classList.contains("open")) toggleMenu();
      }
    });
    document.addEventListener("keydown", (e) => {
      if (e.key === "Escape" && menu.classList.contains("open")) toggleMenu();
    });
  </script>
</body>
</html>
