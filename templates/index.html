<!DOCTYPE html>
<html lang="en">
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>Chat App</title>
  <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/anuragl2h/Discord-bot-lavajukebox@6ae3cf8ebae3a907b31afb551aea25a785914c3b/static/future-ui-FULL.js">
  </script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/anuragl2h/Discord-bot-lavajukebox@775c4d342d5b30a5471dc374f8a613a3ba8a0151/static/future-ui-FULL.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&family=Baloo+2:wght@400;600&family=Nunito:wght@400;700&family=Chewy&family=Merriweather:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
  <style>
  .fu-modal-close{
    display: none;
  }
    /* Minimal reset */
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    body {  font-family: Times New Roman;
      background: radial-gradient(circle at top right,purple,#2F3560,#2D334A, #272C44, #28304A);
    height: 100vh; }

    .div1{
      display: grid; margin: 1vh; border-radius: 5vh; color: white;
      place-items: center; height: 10vh;
      width: 90%;
      place-self: center;
    }
    h1{ font-size: 5.75vh; font-weight: 400;
    place-self: center;
    font-family: 'Poppins',Sans-Serif;
    margin-left: -3vh;
      
    }

    .main{ z-index: 6; max-height: 100vh; height: 90%; position: relative; }

    #messages {
      border: 0.75px solid rgba(39, 44, 68, 0.5);
      box-shadow: 1px 2px 5px #272C44;
      position: absolute; top: 12vh; bottom: 12vh; left: 2vh; right: 2vh;
      overflow-y: auto; padding: 10px; background: transparent;
      backdrop-filter: blur(2000px);
    border-radius: 10px; color: white;

      display: flex; flex-direction: column; gap: 6px;
      
    }
/* Discord-like bubble with a clipped tail */
.msg{
  /* layout */
  align-self: flex-start;         /* left by default */
  max-width: 75%;
  width: fit-content;

  /* look */
  --bg: #2f3136;                  /* bubble color (others) */
  background: var(--bg);
  color: #dcddde;
  padding: 12px 14px;
  border-radius: 12px;
  line-height: 1.4;
  box-shadow: 0 1px 2px rgba(0,0,0,0.35);

  /* smoothness */
  position: relative;
  transition: background 0.2s ease;
}

.msg:hover{ background: #3a3c42; }

/* Tail made with clip-path (left side) */
.msg::after{
  content: "";
  position: absolute;
  left: -8px;             /* stick outside the bubble */
  bottom: 8px;
  width: 16px;
  height: 14px;
  background: var(--bg);
  /* triangle-ish tail */
  clip-path: polygon(100% 0, 0 50%, 100% 100%);
  filter: drop-shadow(0 1px 2px rgba(0,0,0,0.35));
}

/* Your message on the right, mirrored tail */
.msg.me{
  align-self: flex-end;
  --bg: #5865f2;          /* blurple for you */
  color: #fff;
}

.msg.me:hover{ background: #6873f5; }

.msg.me::after{
  left: auto;
  right: -8px;
  transform: scaleX(-1);  /* mirror the tail */
}
    .chatbox{
      position: absolute; bottom: 1vh; left: 1.5vh; right: 12vh;
      border: 0.75px solid #2F3560 ;
      height: 10vh; border-radius: 5vh;background: transparent;
      backdrop-filter: blur(2000px);
      display: flex; align-items: center; padding: 0 3vh;
      transition: background-color 1s ease;
    }
  .chatbox:hover{
    background:#2F3560 ;
  }
    .input{ width: 100%; font-size: 3vh; border: none; outline: none; background:transparent;
      color: skyblue;
    }
    .submit{
      position: absolute; bottom: 1vh; right: 1.5vh;
      height:10vh; width:10vh; border-radius: 50%;
      display: flex; align-items: center; justify-content: center;
       cursor: pointer;
       background: transparent;
       backdrop-filter: blur(2000px);
      transition: background-color 0.3s ease;
      border: 0.75px solid #2F3560;
    }
    .submit1{ font-size: 3.5vh; border: none; background-color: transparent; color: lightblue; 
    }
    .submit1:focus{ outline: none; }
.submit:hover{
  background:rgb(27,131,212) ;
}
.td {
  display: grid;
  place-items: end;
  position: absolute;
  top: 2.5vh;
  right: 2.25vh;
  width: 4vh;
  height: 4vh;
  cursor: pointer;
}

.td dt {
  height: 5px;
  width: 100%;
  background: black;
  border-radius: 5px;
  transition: 0.4s;
}

/* Animation on click */
.td.ro dt:nth-child(1) {
  transform: rotate(45deg) translate(5px, 5px);
}

.td.ro dt:nth-child(2) {
  opacity: 0;
}

.td.ro dt:nth-child(3) {
  transform: rotate(-45deg) translate(6px, -6px);
}

    
    .header{
      background-color: black;  height: max-content; width: max-content;
      padding: 5px;
      position: fixed; top: 12.5vh; right: 1vh; opacity: 0; z-index: -1;
      border: 1px solid purple;
      display: grid; place-items: center; transition: opacity .2s ease, transform .2s ease, ;
      transform: translateY(-8px);
    }
    
    .header.open{
      opacity: 1; z-index: 99; transform: translateY(0); transition: opacity .2s ease, transform 0.2s ease;
      background: #333;
  backdrop-filter: blur(200px);
  border: 1px solid purple;
  
  border-radius: 2vh;
  padding: 15px;
  color: white;
    }
    ul{ list-style:none ;margin-left: 5px; padding: 0px;
    font-family: Poppins;
    font-weight: 500;
    }
    li, a{ font-size: 2.75vh;
    background: transparent;
    border-bottom: 1px solid blue;
    color: white; text-decoration: none;
    }
    a:focus{ text-decoration: none; }
    .rules {
  background: rgba(0,0,0,0.5);
  color: cyan;
  border: 2px solid blue;
  border-radius: 8px;
  padding: 10px;
  margin: 10px;
  font-size: 2vh;
  box-shadow: 0 0 10px cyan;
}
.rules h3 {
  margin-bottom: 6px;
  font-size: 2.5vh;
  text-align: center;
}
#rule{
  justify-self: start;
  vertical-align: center;
}
  </style>
</head>
<body>
  <!-- Slide menu -->
  <div class="header" id="menu">
    <ul>
      <li><a href="https://L2hport.is-a.dev">Portfolio</a></li>
      <li><a href="https://anuragl2h.github.io/L2h-anitrest/index.html">Anime Story</a></li>
      <li><a href="https://discord.gg/urRpFsdJ">join Discord</a></li>
      <li><a href="#" id="set">SettingÔ∏è ‚öôÔ∏è </a></li>
      <li><a id="rule">Rules</a></li>
    </ul>
  </div>


  <div class="main">
    <div class="div1">
      <h1>Chat Verse</h1>
      <!-- Three-dot hamburger trigger -->
      <section class="td" id="menuBtn" aria-label="Open menu">
        <dt></dt><dt></dt><dt></dt>
      </section>
    </div>

    <!-- Chat messages -->
    <div id="messages"></div>

    <!-- Input area -->
    <div class="chatbox">
      <input type="text" id="message" name="message" placeholder="send.." class="input" autocomplete="off">
    </div>
    <div class="submit">
      <button class="submit1" id="sendBtn" aria-label="Send">‚û§</button>
    </div>
  </div>
<div id="fu-container">
  </div>
</body>
<script>
$(function(){
  const socket = io();
let name = localStorage.getItem("UserName");

if (name) {
  console.log("Loaded name from localStorage:", name);
} else {
      $('#message, #sendBtn').prop('disabled', true);

      $.futureUImodal({
        title: "Enter Your Name",
        content: '<input id="inp" class="fu-input" placeholder="whats your name bro/sis" autofocus><button class="fu-btn" id="nameSubmit">Submit</button>',
        autoClose: false,
        onClose: function(){
          console.log("Input value in onClose:", $("#inp").val());
          if (!name) { // Only set if not already set by Submit
            name = $("#inp").val().trim() || "Anonymous";
          }
          console.log("Modal closed, name set to:", name);
          $('#message, #sendBtn').prop('disabled', false);
        }
      });
}

      $(document).on('click', '#nameSubmit', function(){
        const val = $("#inp").val().trim();
        if (!val) {
          $.futureUItoast("Please enter a name!");
          return;
        }
        name = val || Anonymous ;
        localStorage.setItem("UserName",name);
        
        $('.fu-modal-close').click();
      });

      $(document).on('keydown', '#inp', function(e){
        if (e.key === 'Enter') {
          e.preventDefault();
          $('#nameSubmit').click();
        }
      });

  // --- Receive messages ---
  socket.on("message", function(msg){
    const isMe = msg.startsWith(name + ": ");
    const div = $("<div>").addClass("msg").text(msg);
    if(isMe) div.addClass("me");
    $("#messages").append(div);
    $("#messages").scrollTop($("#messages")[0].scrollHeight);
  });

  function sendMessage(){
    const msg = $("#message").val().trim();
    if(!msg) return;
    const abusiveWords = [
  "mc", "MC", "Mc", "mC",
  "bc", "BC", "Bc", "bC",
  "gandu", "GANDU", "Gandu",
  "chutiya", "CHUTIYA", "Chutiya",
  "madarchod", "MADARCHOD", "Madarchod",
  "bhosdike", "BHOSDIKE", "Bhosdike",
  "randi", "RANDI", "Randi",
  "lund", "LUND", "Lund"
];
let isAbusive = abusiveWords.some(word => msg.includes(word));
    if(isAbusive){
    $.futureUItoast("No abusive word allowed")
    msg = none
    }
    socket.send(`${name }: ${msg}`);
    $("#message").val("").focus();
  }
  


  $(".submit").on("click", sendMessage);
  $("#message").on("keydown", function(e){
    if(e.key === "Enter"){
      e.preventDefault();
      sendMessage();
    }
  });

  // --- Menu toggle ---
  $("#menuBtn").on("click", function(){
    $("#menu").toggleClass("open");
    $(this).toggleClass("ro");
  });

  $(document).on("click", function(e){
    if(!$(e.target).closest("#menu, #menuBtn").length){
      if($("#menu").hasClass("open")){
        $("#menu").removeClass("open");
        $("#menuBtn").removeClass("ro");
      }
    }
  });

  $(document).on("keydown", function(e){
    if(e.key === "Escape" && $("#menu").hasClass("open")){
      $("#menu").removeClass("open");
      $("#menuBtn").removeClass("ro");
    }
  });
 $(document).on("click","#set",
  function(){
    $.futureUImodal({
      title : "Setting change username",
      content : `<input id="ni" class="fu-input" placeholder="New username" autofocus><button id="close" class="fu-btn">submit</button>    <button id="moc" class="fu-btn">Close</button`,
      autoClose: false
    })
  }
  )
  $(document).on("click","#close",
  function(){
    val = $('#ni').val().trim()
    name = val || Anonymous ;
        localStorage.setItem("UserName",name);
    $.futureUItoast("Username succesfully changed")
    $('.fu-modal-close').click();
  }
  )
  $(document).on("click","#moc",
  function(){
    $('.fu-modal-close').click();
  }
  )
  $(document).on("click","#rule",
  function(){
    $.futureUImodal({
      title: "rules",
      content: `<div class="fu-toast"> <h3>üö´ No abusive language<br>
  üö´ No personal info<br>
  üö´ No links</h3></div>
  <button id="moc" class="fu-btn">close</button>
  `,
      autoClose: 4500
    })
  }
  )
});
</script>
</html>
