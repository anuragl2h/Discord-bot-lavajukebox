{% extends "base.html" %}

{% block title %}Uptime Monitoring - Discord Music Bot{% endblock %}

{% block content %}
<div class="card">
    <h2>‚è∞ Uptime Monitoring Setup</h2>
    <p>Keep your Discord Music Bot alive 24/7 with external monitoring services</p>
</div>

<div class="card">
    <h3>üéØ Your Bot Endpoints</h3>
    <p>Use these URLs with uptime monitoring services:</p>
    
    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin: 15px 0;">
        <h4>Ping Endpoint (Simple)</h4>
        <code id="ping-url" style="background: #e9ecef; padding: 8px; border-radius: 4px; display: block; margin: 10px 0;">
            Loading...
        </code>
        <p><strong>Use for:</strong> Basic uptime monitoring</p>
    </div>
    
    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin: 15px 0;">
        <h4>Health Check Endpoint (Detailed)</h4>
        <code id="health-url" style="background: #e9ecef; padding: 8px; border-radius: 4px; display: block; margin: 10px 0;">
            Loading...
        </code>
        <p><strong>Use for:</strong> Detailed health monitoring with Discord and music server status</p>
    </div>
</div>

<div class="card">
    <h3>üîß Free Uptime Monitoring Services</h3>
    
    <div class="stats-grid">
        <div class="stat-card" style="text-align: left; padding: 20px;">
            <h4 style="color: #5865f2; margin-bottom: 15px;">UptimeRobot</h4>
            <p><strong>Free Plan:</strong> 50 monitors, 5-minute checks</p>
            <p><strong>Setup:</strong></p>
            <ol style="margin: 10px 0; padding-left: 20px;">
                <li>Sign up at <a href="https://uptimerobot.com" target="_blank">uptimerobot.com</a></li>
                <li>Create "HTTP(s)" monitor</li>
                <li>Use your ping URL above</li>
                <li>Set interval to 5 minutes</li>
            </ol>
        </div>
        
        <div class="stat-card" style="text-align: left; padding: 20px;">
            <h4 style="color: #5865f2; margin-bottom: 15px;">Pingdom</h4>
            <p><strong>Free Plan:</strong> 1 monitor, 1-minute checks</p>
            <p><strong>Setup:</strong></p>
            <ol style="margin: 10px 0; padding-left: 20px;">
                <li>Sign up at <a href="https://pingdom.com" target="_blank">pingdom.com</a></li>
                <li>Create "Uptime" check</li>
                <li>Use your health URL above</li>
                <li>Set check interval</li>
            </ol>
        </div>
        
        <div class="stat-card" style="text-align: left; padding: 20px;">
            <h4 style="color: #5865f2; margin-bottom: 15px;">StatusCake</h4>
            <p><strong>Free Plan:</strong> 10 monitors, 5-minute checks</p>
            <p><strong>Setup:</strong></p>
            <ol style="margin: 10px 0; padding-left: 20px;">
                <li>Sign up at <a href="https://statuscake.com" target="_blank">statuscake.com</a></li>
                <li>Create "Uptime" test</li>
                <li>Use your ping URL above</li>
                <li>Configure notifications</li>
            </ol>
        </div>
        
        <div class="stat-card" style="text-align: left; padding: 20px;">
            <h4 style="color: #5865f2; margin-bottom: 15px;">Better Uptime</h4>
            <p><strong>Free Plan:</strong> 10 monitors, 3-minute checks</p>
            <p><strong>Setup:</strong></p>
            <ol style="margin: 10px 0; padding-left: 20px;">
                <li>Sign up at <a href="https://betteruptime.com" target="_blank">betteruptime.com</a></li>
                <li>Create "HTTP" monitor</li>
                <li>Use your health URL above</li>
                <li>Set up alert channels</li>
            </ol>
        </div>
    </div>
</div>

<div class="card">
    <h3>‚öôÔ∏è Recommended Settings</h3>
    
    <div style="background: #e8f5e8; padding: 15px; border-radius: 8px; border-left: 4px solid #28a745;">
        <h4>Best Practices:</h4>
        <ul>
            <li><strong>Check Interval:</strong> 3-5 minutes (balances reliability with resource usage)</li>
            <li><strong>Timeout:</strong> 30 seconds</li>
            <li><strong>Expected Status:</strong> 200 OK</li>
            <li><strong>Notifications:</strong> Email + Discord webhook if available</li>
            <li><strong>Multiple Services:</strong> Use 2-3 different providers for redundancy</li>
        </ul>
    </div>
    
    <div style="background: #ffeaa7; padding: 15px; border-radius: 8px; border-left: 4px solid #fdcb6e; margin-top: 15px;">
        <h4>‚ö†Ô∏è Development URL Limitation:</h4>
        <p><strong>Problem:</strong> Your current Replit development URL is temporary and changes when the project restarts. This makes it unreliable for 24/7 uptime monitoring.</p>
        <p><strong>Solution:</strong> Use free permanent hosting services below for a stable URL that never changes.</p>
    </div>
    
    <div style="background: #d4edda; padding: 15px; border-radius: 8px; border-left: 4px solid #28a745; margin-top: 15px;">
        <h4>üÜì Free Permanent Hosting Options:</h4>
        <ul>
            <li><strong>Railway.app:</strong> 512MB RAM, $5 monthly credit free - RECOMMENDED</li>
            <li><strong>Render.com:</strong> 750 hours/month free (enough for 24/7)</li>
            <li><strong>Fly.io:</strong> 3 shared VMs free</li>
            <li><strong>See full setup guide:</strong> Check the FREE_HOSTING_GUIDE.md file in your project</li>
        </ul>
    </div>
    
    <div style="background: #fff3cd; padding: 15px; border-radius: 8px; border-left: 4px solid #ffc107; margin-top: 15px;">
        <h4>Important Notes:</h4>
        <ul>
            <li>Your current Replit URL can be used for monitoring right now</li>
            <li>Test endpoints manually before setting up monitoring</li>
            <li>Use the health endpoint for better monitoring of Discord connection</li>
            <li>Free tier has some limitations but works great for personal bots</li>
        </ul>
    </div>
</div>

<div class="card">
    <h3>üìä Test Your Endpoints</h3>
    <div style="margin: 20px 0;">
        <button class="btn" onclick="testPing()">Test Ping Endpoint</button>
        <button class="btn" onclick="testHealth()">Test Health Endpoint</button>
    </div>
    
    <div id="test-results" style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-top: 15px; display: none;">
        <h4>Test Results:</h4>
        <pre id="test-output" style="background: #e9ecef; padding: 10px; border-radius: 4px; overflow-x: auto;"></pre>
    </div>
</div>

<div class="card">
    <h3>üÜì Free Keep-Alive Methods</h3>
    
    <h4>Method 1: Free Monitoring Services</h4>
    <p>Use the services above - they're completely free and work with your current Replit URL</p>
    
    <h4>Method 2: GitHub Actions (Free)</h4>
    <div style="background: #1a1a1a; color: #00ff41; padding: 15px; border-radius: 8px; font-family: monospace; margin: 10px 0;">
        <p># .github/workflows/keepalive.yml</p>
        <p>name: Keep Bot Alive</p>
        <p>on:</p>
        <p>  schedule:</p>
        <p>    - cron: '*/5 * * * *'</p>
        <p>jobs:</p>
        <p>  ping:</p>
        <p>    runs-on: ubuntu-latest</p>
        <p>    steps:</p>
        <p>      - run: curl -s <span id="cron-url">YOUR_URL_HERE</span>/ping</p>
    </div>
    
    <h4>Method 3: Free VPS/Service</h4>
    <ul>
        <li><strong>Railway:</strong> 512MB RAM free tier</li>
        <li><strong>Render:</strong> 750 hours/month free</li>
        <li><strong>Heroku alternatives:</strong> Many free options available</li>
    </ul>
    
    <h4>Method 4: Discord Bot Lists</h4>
    <p>Some bot listing sites provide free keep-alive pinging for listed bots</p>
</div>

<div style="text-align: center; margin-top: 30px;">
    <a href="/" class="btn">‚Üê Back to Dashboard</a>
    <button class="btn" onclick="copyUrls()">Copy All URLs</button>
</div>

<script>
// Set URLs based on current domain
function setUrls() {
    const baseUrl = window.location.origin;
    const pingUrl = baseUrl + '/ping';
    const healthUrl = baseUrl + '/health';
    
    document.getElementById('ping-url').textContent = pingUrl;
    document.getElementById('health-url').textContent = healthUrl;
    document.getElementById('cron-url').textContent = baseUrl;
    
    // Show free usage note
    const freeNote = document.createElement('div');
    freeNote.style.cssText = 'background: #d1ecf1; padding: 10px; border-radius: 5px; margin-top: 10px; border-left: 4px solid #17a2b8;';
    freeNote.innerHTML = '<strong>üí° Free Usage:</strong> You can use these URLs right now with monitoring services - no deployment cost required!';
    
    document.getElementById('ping-url').parentElement.appendChild(freeNote.cloneNode(true));
}

function testPing() {
    const resultsDiv = document.getElementById('test-results');
    const outputPre = document.getElementById('test-output');
    
    resultsDiv.style.display = 'block';
    outputPre.textContent = 'Testing ping endpoint...';
    
    fetch('/ping')
        .then(response => response.json())
        .then(data => {
            outputPre.textContent = 'PING TEST - SUCCESS\n\n' + JSON.stringify(data, null, 2);
        })
        .catch(error => {
            outputPre.textContent = 'PING TEST - ERROR\n\n' + error.message;
        });
}

function testHealth() {
    const resultsDiv = document.getElementById('test-results');
    const outputPre = document.getElementById('test-output');
    
    resultsDiv.style.display = 'block';
    outputPre.textContent = 'Testing health endpoint...';
    
    fetch('/health')
        .then(response => response.json())
        .then(data => {
            outputPre.textContent = 'HEALTH TEST - SUCCESS\n\n' + JSON.stringify(data, null, 2);
        })
        .catch(error => {
            outputPre.textContent = 'HEALTH TEST - ERROR\n\n' + error.message;
        });
}

function copyUrls() {
    const baseUrl = window.location.origin;
    const urls = `Ping: ${baseUrl}/ping\nHealth: ${baseUrl}/health`;
    
    navigator.clipboard.writeText(urls).then(() => {
        alert('URLs copied to clipboard!');
    }).catch(() => {
        alert('Could not copy URLs. Please copy them manually.');
    });
}

// Initialize URLs when page loads
document.addEventListener('DOMContentLoaded', setUrls);
</script>
{% endblock %}